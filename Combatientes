public class Combatientes{
    private String nombre;
    private int PV;
    private int PA;
    private boolean inhabilitado;
    private int aumentoAtaque;
    private int escudoActivo;
    private boolean turnoExtra;
    private int turnosInhabilitado = 0;
    private int turnosVeneno = 0;
    private int danoVenenoPorTurno = 0;

    public Combatientes(String nombre){
        this.nombre = nombre;
        this.PV = 100;
        this.PA = 20;
        this.inhabilitado = false;
        this.aumentoAtaque = 0;
        this.escudoActivo = 0;
        this.turnoExtra = false;
    }

    public String getNombre(){
        return nombre;
    }
    public int getPV(){
        return PV;
    }
    public int getPA(){
        return PA + aumentoAtaque;
    }
    public boolean isInhabilitado(){
        return inhabilitado || turnosInhabilitado > 0;
    }
      public void setInhabilitado(boolean inhabilitado){
        this.inhabilitado = inhabilitado;
    }
    public void setInhabilitadoPorTurnos(int turnos){
        // si ya está inhabilitado por más turnos, no reducirlo
        this.turnosInhabilitado = Math.max(this.turnosInhabilitado, Math.max(0, turnos));
        this.inhabilitado = false; 
    }
    public boolean tieneTurnoExtra(){
        return turnoExtra;
    }
    public void otorgarTurnoExtra(){
        this.turnoExtra = true;
    }
    public void usarTurnoExtra(){
        this.turnoExtra = false;
    }
    // Ayuda a ver cuanto daño recibe el combatiente, reduciendo los puntos de vida del mismo
    public void recibirDano(int dano){
        //si es curación (dano < 0), ignorar escudo para que sí cure
        if (dano < 0) {
            this.PV -= dano; // dano negativo suma PV
            System.out.println(nombre + " ha sido curado por " + (-dano) + ". PV actuales: " + PV);
        } else if (escudoActivo > 0){
           int danoReducido = Math.max(dano - escudoActivo, 0);// Math.max evita daño negativo
           escudoActivo = 0;
           this.PV -= danoReducido;
           System.out.println(nombre + " ha recibido " + danoReducido + " tras la activación de su escudo. PV: " + PV);
        }else{
            this.PV -= dano; // Resta el daño directamente a los puntos de vida
            System.out.println(nombre + " ha recibido " + dano + " de daño. PV restantes: " + PV);
        }
        if (this.PV < 0) this.PV = 0;
    }
    //Método de aumento de ataque 
    public void aplicarAumentoAtaque(int valor){
        this.aumentoAtaque += valor;
        System.out.println(nombre + " ha aumentado su ataque en " + valor + ". PA actual: " + getPA());
    }

    public void resetearAumentoAtaque(){
        this.aumentoAtaque =0; // resetea el aumento de ataque a 0, osea no tiene un aumento dle mismo
    }
    //activa el escudo del combatiente
    public void activarEscudo(int valor){
        this.escudoActivo = valor;
    }

    public boolean estaVivo() {
    return PV > 0;
    }
    public void aplicarVeneno(int danoPorTurno, int turnos){
        this.danoVenenoPorTurno = Math.max(this.danoVenenoPorTurno, Math.max(0, danoPorTurno));
        this.turnosVeneno = Math.max(this.turnosVeneno, Math.max(0, turnos));
        System.out.println(nombre + " ha sido envenenado (" + danoPorTurno + " por turno, " + turnos + " turnos).");
    }
    public void avanzarEstadosDeTurno(){
        if (turnosVeneno > 0) {
            recibirDano(danoVenenoPorTurno);
            turnosVeneno--;
            if (turnosVeneno == 0) {
                danoVenenoPorTurno = 0;
                System.out.println(nombre + " ya no está envenenado.");
            }
        }
        if (turnosInhabilitado > 0) {
            turnosInhabilitado--;
            if (turnosInhabilitado == 0) {
                System.out.println(nombre + " ya no está inhabilitado.");
            }
        }
    }
    // Muestra el estado actual del combatiente
    @Override
    public String toString() {
        return "Combatientes{" +
                "nombre='" + nombre + '\'' +
                ", PV=" + PV +
                ", PA=" + PA +
                '}';
    }
    // Método equals para comparar dos objetos Combatientes
    @Override
    public boolean equals(Object obj){
        if (this == obj) return true;
        if (obj == null || getClass() != obj.getClass()) return false;
        Combatientes that = (Combatientes) obj; // Convierte el objeto a Combatientes
        return PV == that.PV && PA == that.PA && java.util.Objects.equals(nombre,that.nombre);// Compara los atributos para determinar si son iguales
    }
}